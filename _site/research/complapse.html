<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dr.&nbsp;Olga Perski - COMPLAPSE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WF7G4G33CE"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WF7G4G33CE', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../styles.css">
<meta name="twitter:title" content="Dr.&nbsp;Olga Perski - COMPLAPSE">
<meta name="twitter:description" content="Improving the precision of behaviour change theories: Development and validation of a dynamic COMPutational model of LAPSE risk in smokers attempting to stop">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Dr.&nbsp;Olga Perski</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../research/complapse.html"><i class="bi bi-graph-up" role="img">
</i> 
 <span class="dropdown-text">COMPLAPSE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/emasens.html"><i class="bi bi-smartwatch" role="img">
</i> 
 <span class="dropdown-text">EMASENS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/odh_database.html"><i class="bi bi-door-open-fill" role="img">
</i> 
 <span class="dropdown-text">Open Digital Health initiative Living Review &amp; Database Development</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/vr_smoking.html"><i class="bi bi-badge-vr" role="img">
</i> 
 <span class="dropdown-text">Virtual Reality for Smokers Unmotivated to Stop</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/wellbeing_students.html"><i class="bi bi-balloon-heart" role="img">
</i> 
 <span class="dropdown-text">Mental Wellbeing in Swedish University Students During COVID-19</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/fsa_qat.html"><i class="bi bi-card-checklist" role="img">
</i> 
 <span class="dropdown-text">UK Food Standards Agency - Quality Assurance Toolkit</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/ema_review.html"><i class="bi bi-sliders" role="img">
</i> 
 <span class="dropdown-text">Systematic Review of Ecological Momentary Assessment Studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/covid.html"><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">COVID-19, Smoking and Personal Protective Behaviours</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/engagement.html"><i class="bi bi-phone-vibrate" role="img">
</i> 
 <span class="dropdown-text">Acceptability of and Engagement with Digital Behaviour Change Interventions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/sts_ats.html"><i class="bi bi-house-door" role="img">
</i> 
 <span class="dropdown-text">UCL Smoking &amp; Alcohol Toolkit Studies</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.co.uk/citations?user=t7lihTUAAAAJ&amp;hl=en">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../talks.html">
 <span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching.html">
 <span class="menu-text">Teaching and supervision</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../media.html">
 <span class="menu-text">Public engagement</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../policy.html">
 <span class="menu-text">Policy engagement</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../consultancies.html">
 <span class="menu-text">Consultancies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#wp1" id="toc-wp1" class="nav-link active" data-scroll-target="#wp1">WP1</a></li>
  <li><a href="#wp2" id="toc-wp2" class="nav-link" data-scroll-target="#wp2">WP2</a></li>
  <li><a href="#wp3" id="toc-wp3" class="nav-link" data-scroll-target="#wp3">WP3</a></li>
  <li><a href="#dissemination" id="toc-dissemination" class="nav-link" data-scroll-target="#dissemination">Dissemination</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">COMPLAPSE</h1>
<p class="subtitle lead">Improving the precision of behaviour change theories: Development and validation of a dynamic COMPutational model of LAPSE risk in smokers attempting to stop</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<center>
<p><img src="complapse.jpg" class="img-fluid" style="width:60.0%"></p>
<figcaption>
Photo by Unsplash
</figcaption>
</center>
<p><br></p>
<p>Cigarette smoking remains the leading preventable cause of premature morbidity and mortality in Europe and beyond. Gold standard treatment for smoking cessation includes pharmacotherapy and behavioural support. However, smoking lapses – influenced by momentary fluctuations in cigarette availability, stress, and cravings – are a key source of treatment failure. COMPLAPSE aims to advance the state-of-the-art by developing and validating a dynamic computational model of lapse risk, improving the precision of static behaviour change theories to account for observed complexities and laying the foundation for dynamically tailored, person-centred digital smoking cessation interventions for increased effectiveness. COMPLAPSE is interdisciplinary in scope – drawing on know-how from behavioural science, engineering, and computer science – and directly contributes to Europe’s Path to the Digital Decade and its Strategic Framework for the Prevention of Non-Communicable Diseases.</p>
<p>COMPLAPSE is funded by the European Commission under the Horizon Europe Framework Programme (HORIZON), Grant No.&nbsp;101065293 (PI: Dr.&nbsp;Olga Perski; Co-Is: Prof.&nbsp;Nelli Hankonen, Prof.&nbsp;Eric Hekler and Prof.&nbsp;Misha Pavel).</p>
<p>More specifically, COMPLAPSE aims to:</p>
<ol type="1">
<li>Develop a conceptual model of lapse risk, drawing on knowledge of the available literature and stakeholder input (addressed in WP1);</li>
<li>Formulate mathematical equations for the components of the conceptual model and perform a series of computer simulations within the R environment (addressed in WP2);</li>
<li>Collect EMA and sensor data and use this to validate the expert-derived computational model (addressed in WP3).</li>
</ol>
<p>See Figure 1 for an overview of the WPs within COMPLAPSE.</p>
<center>
<p><img src="complapse_gantt.png" class="img-fluid" style="width:100.0%"></p>
<figcaption>
Figure 1. Gantt chart of the WPs, tasks, deliverables and milestones within COMPLAPSE.
</figcaption>
</center>
<p><br></p>
<section id="wp1" class="level3">
<h3 class="anchored" data-anchor-id="wp1">WP1</h3>
<p>Drawing on knowledge of the extant literature (including a recent <a href="https://psyarxiv.com/au498/">systematic review and meta-analysis</a>), the core project team will iteratively develop a prototype conceptual model using Lucidchart. Next, stakeholders (i.e., collaborators, consultants and participants) will be invited to critique and add to (or remove from) the prototype conceptual model through a series of virtual focus groups, inspired by participatory systems mapping methodology (Barbrook-Johnson &amp; Penn, 2021). Stakeholders will be invited to co-author the resulting paper(s). However, as co-authorship is not necessarily beneficial for all stakeholder groups, consultants and participants will also receive a €20 voucher as remuneration for their time and effort.</p>
<p>We aim to involve the following stakeholder groups:</p>
<p><strong>Collaborators:</strong> Scientific researchers or policymakers/tobacco control experts working across universities, research institutes, government or not-for-profit organisations specialising in behaviour change theory, smoking cessation, or computational modelling (n=6);</p>
<p><strong>Consultants:</strong> Policymakers/tobacco control experts working across government and not-for-profit organisations or stop smoking practitioners working across dedicated stop smoking services or general medical practice, with a particular focus on consultants with experience of working with smokers with specific needs, such as smokers with mental health problems (n=6);</p>
<p><strong>Participants:</strong> Adult, daily smokers interested in quitting (n=6).</p>
<p>Stakeholders will be eligible to take part if they are aged 18+ years and are a fluent English speaker. People who declare a financial or non-financial tie with the tobacco industry are not eligible to take part.</p>
<p>To enable exploration of how factors at multiple systems levels (e.g., neighbourhood-, city-, and country-level factors) influence lapse risk trajectories for different individuals, we aim to recruit stakeholders (and subsequently collect empirical data) across several geographies. As the lead researcher is based in the United States (San Diego, California) and Finland (Tampere) for the duration of the project and is affiliated with a university in the United Kingdom (London) – with networks and resources for data collection in these locations – these countries/cities will be used as case studies.</p>
<p>Stakeholders will be recruited through the core project team’s networks and social media platforms (e.g., Twitter, Facebook). At least 50% of smokers recruited will be from lower socioeconomic position (SEP) groups – defined as having no post-16 educational qualifications – and an equal proportion of women and men will be recruited. E-mails outlining the purpose and procedure for the participatory systems mapping activity will be sent in batches until the target for each stakeholder group is met.</p>
<p>Within each virtual focus group session (2-4 people, to accommodate time zone differences and availability), stakeholders will be asked to critique and add to the prototype conceptual model developed by the core project team. For example, stakeholders will be asked if they think any key components are missing (or should be removed) and ideas for how to differently represent the system dynamics. Field notes will be taken and findings from each focus group will be integrated and translated into a table with information about the expected direction, magnitude, and rate of change of the model components. The participatory systems mapping approach does not guarantee the identification of an exhaustive range of factors that influence the system dynamics. However, it is a well-established method for challenging mental models and ensuring that a wide range of perspectives are considered and represented in the research. The conceptual model will serve as a starting point for the development of the computational model in WP2.</p>
</section>
<section id="wp2" class="level3">
<h3 class="anchored" data-anchor-id="wp2">WP2</h3>
<p>Next, mathematical equations (e.g., difference or differential equations) will be formulated for each component in the conceptual model and translated into R code to align with the expert-derived domain-specific knowledge, including equations which are treated as deterministic and those that require probabilistic elements (e.g., the probability of experiencing a stressful event or encountering a smoking cue). Drawing on the table developed in WP1, initial parameter values for the computational model will be selected and simulations will be run in the R environment. A series of sensitivity analyses will be conducted with different starting conditions for the model parameters until the output resembles expected behaviour for different ‘archetypes’ of smokers, including, for example, a smoker who quickly relapses, and a smoker who initially lapses but subsequently bounces back to abstinence. The change in the variance explained will be systematically explored by ignoring (i.e., fixing at their mean value) key model components. This will help understand and calibrate each contributing source of uncertainty. The model output will be visualised in the R environment using time series plots. Stakeholders will be invited to provide feedback on the model output.</p>
</section>
<section id="wp3" class="level3">
<h3 class="anchored" data-anchor-id="wp3">WP3</h3>
<p>Next, EMA and sensor data will be collected to validate the computational model. Participants will be recruited via social media platforms (e.g., Twitter, Facebook). Eligibility criteria will include being an adult, daily smoker who i) owns a smartphone, ii) is willing to make a quit attempt, and iii) is willing to respond to regular EMAs and wear a sensor for the duration of the study (to be determined following the results from WPs 1-2). At least 50% of smokers will be recruited from lower socioeconomic position groups and an equal proportion of women and men will be recruited.</p>
<p>Eligible participants will be asked to download an EMA application onto their smartphone and will be provided with a recently validated wearable sensor with suitable functionality. Given substantial evidence that unaided smoking cessation attempts have low odds of success (Raupach et al., 2013), participants will receive brief, evidence-based behavioural support. Throughout the study, participants will be asked to complete brief EMAs multiple times per day in response to random prompts, in addition to self-initiated (i.e., event-contingent) ‘lapse’ EMAs. The questionnaire items and the variables derived from the sensor data (e.g., heart rate variability, geolocation tracking) – and their respective sampling frequency (e.g., day, hour, minute) – will correspond to the expert-derived computational model developed in WPs 1-2. The questionnaire items and sensor data will be designed to capture factors such as cravings, self-regulatory skills (operationalised as high heart rate variability – considered an indicator of autonomic nervous system regulation (Holzman &amp; Bridgett, 2017) – and measured with the wearable sensor), motivation to stop, and cigarette availability. Where possible, validated questionnaires will be used. As social desirability bias may lead some participants to falsely report being abstinent via the self-reported EMAs, we will follow the Society for Research on Nicotine and Tobacco’s (SRNT) recommendation to use biochemical verification to distinguish smokers from non-smokers. Exhaled carbon monoxide (eCO) is a valid and reliable indicator of recent smoke absorption from combustible tobacco products (e.g., cigarettes, cigars) and does not capture the use of electronic nicotine delivery systems (e.g., e-cigarettes). Participants will be asked to provide an eCO reading at the end of the study period. SRNT recommends using cut-offs of 8-10 parts per million for distinguishing smokers from non-smokers.</p>
<p>A head-to-head comparison of the predictive power – operationalised as the variance accounted for in the output variable or the R2 – of the computational model with a set of simpler models informed by current state-of-the-art theories, such as Social Cognitive Theory, will be performed.</p>
</section>
<section id="dissemination" class="level3">
<h3 class="anchored" data-anchor-id="dissemination">Dissemination</h3>
<p>This website will be used for dissemination of findings from project COMPLAPSE, including scientific publications, talks, blog entries/’vlogs’, workshops and podcasts.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>